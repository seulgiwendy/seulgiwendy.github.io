<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>봄이네집 개발 블로그</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="봄이네집 개발 블로그">
<meta property="og:url" content="https://tech.wheejuni.com/page/5/index.html">
<meta property="og:site_name" content="봄이네집 개발 블로그">
<meta property="og:locale" content="ko">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="봄이네집 개발 블로그">
  
    <link rel="alternate" href="/atom.xml" title="봄이네집 개발 블로그" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:100,300,400,700&amp;subset=korean" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <!--<div id="banner"></div>-->
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <a href="/" id="main-nav-title" class="main-nav-link">봄이네집 개발 블로그</a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/about/">about</a>
        
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-bruteforce-protection" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/13/bruteforce-protection/">브루트 포스 공격을 막아봅시다.(Spring Security에서의 예외 처리)</a>
    </h1>
  

        <a href="/2017/12/13/bruteforce-protection/" class="article-date">
  <time datetime="2017-12-13T12:27:35.000Z" itemprop="datePublished">2017-12-13</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="간단한-브루트-포스-Brute-Force-공격을-막아보자"><a href="#간단한-브루트-포스-Brute-Force-공격을-막아보자" class="headerlink" title="간단한 브루트 포스(Brute Force) 공격을 막아보자."></a>간단한 브루트 포스(Brute Force) 공격을 막아보자.</h3><p>말은 거창하지만 간단하다. 브루트 포스(Brute Force)란 비밀번호가 맞을 때까지 노가다로 때려맞히는, 아주 원초적이지만 효과적이고 또 돈도 안 드는 공격 방식이다. </p>
<p>3G 통신이 상용화도 되기 전 대부분의 핸드폰들은 단순한 4자리의 암호 체게를 갖고 있었고, 기본 비밀번호는 4빵, 즉 0000 이었다. 친구들의 핸드폰을 탈취해 꼭 시도해봤던 일 중 하나는 이 네 자리의 암호를 때려맞혀 보는 일이었다. </p>
<p>비밀번호는 숫자 네 자리로만 이뤄져있으니 단순한 계산으로 생각해보면 0000~9999의 숫자를 한 번씩만 시도해보면 언젠가는 비밀번호를 알아낼 수 있을 일이었다. 그러나 한 다섯번 쯤 시도하면 늘 뜨는 에러 메시지, <em>입력 횟수 초과! n분 후에 시도하세요.</em> 가 나의 원대한 도전을 늘 가로막았었다. </p>
<h4 id="이런-식의-공격이-요즘-웹에-의미가-있나"><a href="#이런-식의-공격이-요즘-웹에-의미가-있나" class="headerlink" title="이런 식의 공격이 요즘 웹에 의미가 있나?"></a>이런 식의 공격이 요즘 웹에 의미가 있나?</h4><p>결론부터 말하면 <strong>의미없다고 생각한다.</strong> 브루트 포스 공격이 통하기엔 이미 모던 웹 서비스들은 복잡도가 너무 높은 비밀번호를 요구하고 있다(주인도 까먹어서 문제다). 또 이런 비밀번호에 대한 유효성 검증을 회원가입 시에 프론트 단에서 구현해주기 때문에 브루트 포스 공격으로 비밀번호가 털릴 상황은 그렇게 많이 연출되지 않을 거라고 본다. </p>
<p>그러나 스프링 시큐리티에서의 브루트 포스 방어는 Spring Boot 기반 프로젝트에서의 캐시 사용, Exception Handler 구현 등 연습해볼 만한 도전과제가 넘쳐나는 구현이다. </p>
<p>따라서 나는 실 서비스를 위한 보안 목적이라기보단 학습 목적으로 이번 구현을 시작했음을 미리 밝혀둔다. </p>
<h4 id="무엇을-어디서"><a href="#무엇을-어디서" class="headerlink" title="무엇을? 어디서?"></a>무엇을? 어디서?</h4><p>로그인 과정 상에서 Exception을 발생시켜 로그인 로직 자체를 멈추게 할 것이란 계획은 세웠다, 그렇다면 <strong>무슨 Exception을 어디서 발생시키나?</strong> 를 고민해야 한다.</p>
<p>우선 누가 암호를 몇 번 틀렸는지 기록하기 위해 com.google.commons에 들어있는 <a href="https://google.github.io/guava/releases/19.0/api/docs/com/google/common/cache/LoadingCache.html" target="_blank" rel="noopener">LoadingCache</a>를 사용할 것이다. Key는 String으로, 횟수를 저장할 Value는 Integer로 저장할 것이다. 또 이 Cache 인스턴스를 들고 있으면서 특정 IP의 차단 여부를 판별하고, 로그인 성공 / 실패 이벤트가 생길 때마다 저장 내용을 조작할 LoginAttemptService를 구현할 것이다.</p>
<p>Exception은 RuntimeException을 상속받는 LoginAttemptExceedException을 만들어 줄 것이며, CustomUserDetailsService.loadByUsername()으로 유저 정보 질의가 들어왔을 때 해당 IP의 차단 여부를 체크해 Exception을 발생시키게 된다. 이를 위해 CustomUserDetailsService는 LoginAttemptService를 Autowire받게 된다. </p>
<h4 id="LoginAttemptService"><a href="#LoginAttemptService" class="headerlink" title="LoginAttemptService"></a>LoginAttemptService</h4><p>로그인 실패 시도를 기록하고 차단 여부를 알려줄 서비스는 아래와 같이 구현한다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class LoginAttemptService &#123;</span><br><span class="line"></span><br><span class="line">    private final int MAX_ATTEMPT = 2; //허용 시도횟수 두번. </span><br><span class="line">    private LoadingCache&lt;String, Integer&gt; attemptsCache;</span><br><span class="line"></span><br><span class="line">    public LoginAttemptService() &#123;</span><br><span class="line">        super();</span><br><span class="line">        attemptsCache = CacheBuilder.newBuilder()</span><br><span class="line">                .expireAfterWrite(1, TimeUnit.DAYS).build(new CacheLoader&lt;String, Integer&gt;() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public Integer load(String key) throws Exception &#123;</span><br><span class="line">                        return 0;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void loginSucceeded(String key) &#123;</span><br><span class="line">        attemptsCache.invalidate(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void loginFailed(String key) &#123;</span><br><span class="line">        int attempts = 0;</span><br><span class="line">        try &#123;</span><br><span class="line">            attempts = attemptsCache.get(key);</span><br><span class="line">        &#125; catch(ExecutionException e) &#123;</span><br><span class="line">            attempts = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        attempts++;</span><br><span class="line">        attemptsCache.put(key, attempts);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void resetAttempt(String key) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            attemptsCache.put(key, 0);</span><br><span class="line">        &#125; catch(Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public boolean isBlocked(String key) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            return attemptsCache.get(key) &gt;= MAX_ATTEMPT;</span><br><span class="line">        &#125; catch (ExecutionException e) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>LoadingCache의 .get()이 Exception을 발생시키는 점이 맘에 들지 않지만…. 그냥 Optional<t> 로 구현하면 더 나았을텐데. 하긴 LoadingCache는 인터페이스에 불과하므로 CacheBuilder를 쓰지 않고 내가 직접 구현해서 쓰는 것도 방법이 될 수 있겠다. </t></p>
<h4 id="IntegratedFormloginFailureHandler"><a href="#IntegratedFormloginFailureHandler" class="headerlink" title="IntegratedFormloginFailureHandler"></a>IntegratedFormloginFailureHandler</h4><p>클래스명이 쓸데없이 거창한 모습이다. 이 핸들러를 통해 로그인 에러 페이지도 커스터마이즈하고 싶었기에 클래스명을 이렇게 붙여 봤다. </p>
<p>구현은 아래와 같이…. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class IntegratedFormloginFailureHandler implements AuthenticationFailureHandler &#123;</span><br><span class="line">    private static final Logger log = LoggerFactory.getLogger(IntegratedFormloginFailureHandler.class);</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onAuthenticationFailure(HttpServletRequest req, HttpServletResponse res, AuthenticationException e) throws IOException, ServletException &#123;</span><br><span class="line">        if (isBruteForceEvent(e)) &#123;</span><br><span class="line">            log.error(&quot;brute force event detected from failure handler!&quot;);</span><br><span class="line">            log.error(&quot;cause of exception : &#123;&#125;&quot; , e.getCause().getClass().getName());</span><br><span class="line">            res.sendRedirect(&quot;/captcha&quot;);//횟수 초과 시에 이동할 주소.</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        log.error(&quot;general sign-in fail event detected from failure handler!&quot;);</span><br><span class="line">        res.sendRedirect(&quot;/signin&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isBruteForceEvent(AuthenticationException e) &#123;</span><br><span class="line">        return e.getCause() instanceof LoginAttemptExceedException;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>isBruteForceEvent()의 e.getCause()가 신경이 쓰일 거라 생각한다. 사실 이렇게 구현해야 한다는 것을 수십번의 삽질, 그리고 Throwable에 대한 학습 후 알아낼 수 있었다. </p>
<p>우선 로그인 과정에서 Exception이 발생했을 때 콘솔에 어떤 메시지가 뜨는지를 살펴보자 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.security.authentication.InternalAuthenticationServiceException: login attempt exceeds!</span><br><span class="line">	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:126)</span><br><span class="line">	(...)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">Caused by: codesquad.security.Exceptions.LoginAttemptExceedException: login attempt exceeds!</span><br><span class="line">	at codesquad.security.CustomUserDetailsService.loadUserByUsername(CustomUserDetailsService.java:49)</span><br><span class="line">	at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:114)</span><br><span class="line">	... 53 common frames omitted</span><br></pre></td></tr></table></figure>
<p>Stack Trace상에서 Caused By: 를 주목할 필요가 있겠다. 우선 Spring Security에서 사용자 인증 과정중에 발생한 모든 Exception은 InternalAuthenticationServiceException으로 Wrapping된 후에 던져진다는 점을 알 수 있었다. <strong>이걸 알기 전까지 무수한 삽질을 반복해야 했다.</strong> 이걸 모르고 Handler상에서 LoginAttemptExceedException을 바로 찾았으니 당연히 찾아지지 않았다. </p>
<p>InternalAuthenticationServiceException을 뜯어보면 이 클래스는 AuthenticationServiceException을 상속받고 있고 이는 다시 AuthenticationException을 상속받은 예외다. </p>
<p>스프링 시큐리티가 예외 처리용으로 제공하는 AuthenticationFailureHandler 인터페이스의 .onAuthenticationFailure() 메소드는 AuthenticationException을 인자로 받고 있는데, Spring Security 단에서 발생하는 모든 AuthenticationException과 이를 상속받은 예외들이 이 Handler를 통해 처리되게 되는 것이다. </p>
<p>사용자 인증 과정에서 발생하는 <strong>AuthenticationException을 상속받지 않은 모든 예외는 InternalAuthenticationServiceException으로 감싸진 채로 던져지므로</strong> e.getCause()를 호출해 Cause Exception을 불러와야 우리가 구현한 LoginAttemptExceedException의 내용을 확인할 수 있는 것이다. </p>
<p>아, 말로 써놓고 보니 어렵다. 이런 방식을 Chained Exception 이라고 하는 것 같은데 <a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/chained.html" target="_blank" rel="noopener">이 글</a>을 참고해 보면 좋겠다. </p>
<p>어려운 구현은 다 끝났고 남은 건 자질구레한 설정들이다. </p>
<h4 id="Spring-Security의-SecurityConfig을-일부-변경"><a href="#Spring-Security의-SecurityConfig을-일부-변경" class="headerlink" title="Spring Security의 SecurityConfig을 일부 변경."></a>Spring Security의 SecurityConfig을 일부 변경.</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableOAuth2Client</span><br><span class="line">public class SecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    private IntegratedFormloginFailureHandler failureHandler = new IntegratedFormloginFailureHandler();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">     .formLogin()</span><br><span class="line">                    .loginPage(&quot;/signin&quot;)</span><br><span class="line">                    .loginProcessingUrl(&quot;/signin&quot;)</span><br><span class="line">                    .successHandler(this.signinRedirectionHandler)</span><br><span class="line">                    .failureHandler(this.failureHandler)//아까 공들여 만든 실패 핸들러를 등록시켜준다. </span><br><span class="line">                    .permitAll()</span><br></pre></td></tr></table></figure>
<h4 id="CustomUserDetailsService가-IP-차단-여부를-체크하도록-변경"><a href="#CustomUserDetailsService가-IP-차단-여부를-체크하도록-변경" class="headerlink" title="CustomUserDetailsService가 IP 차단 여부를 체크하도록 변경."></a>CustomUserDetailsService가 IP 차단 여부를 체크하도록 변경.</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123;</span><br><span class="line">        log.debug(&quot;load username : &#123;&#125;&quot; , username);</span><br><span class="line"></span><br><span class="line">        String ip = getClientIP();</span><br><span class="line">        if (loginAttemptService.isBlocked(ip)) &#123;</span><br><span class="line">            </span><br><span class="line">            throw new LoginAttemptExceedException(&quot;login attempt exceeds!&quot;);</span><br><span class="line">      </span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //클라이언트의 IP를 알아내는 메소드</span><br><span class="line"></span><br><span class="line">    private String getClientIP() &#123; </span><br><span class="line">        String header = req.getHeader(&quot;X-Forwarded-For&quot;);</span><br><span class="line">        if (header == null) &#123;</span><br><span class="line">            return req.getRemoteAddr();</span><br><span class="line">        &#125;</span><br><span class="line">        return header.split(&quot;,&quot;)[0];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>어때요, 참 쉽죠?</strong></p>
<p>리디렉션을 /captcha로 돌려주는 것에서 이미 짐작하셨겠지만 다음 구현과제는 Google의 <a href="https://www.google.com/recaptcha/intro/android.html" target="_blank" rel="noopener">reCAPTCHA</a>를 서비스에 적용해보는 것이다. </p>
<h4 id="유용했던-참고자료"><a href="#유용했던-참고자료" class="headerlink" title="유용했던 참고자료"></a>유용했던 참고자료</h4><p><a href="http://www.baeldung.com/spring-security-block-brute-force-authentication-attempts" target="_blank" rel="noopener">Prevent Brute Force Authentication Attempts with Spring Security</a></p>
<p><a href="https://google.github.io/guava/releases/19.0/api/docs/com/google/common/cache/LoadingCache.html" target="_blank" rel="noopener">LoadingCache Javadoc</a></p>
<p>+포비의 힌트. 감사합니다~!</p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/12/13/bruteforce-protection/" data-id="ckk8zmerp003qeo9oix2aoczg" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/12/13/bruteforce-protection/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring-Security/">Spring_Security</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sentry-on-spring" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/08/sentry-on-spring/">스프링 앱을 센트리로 감시하자. (+스프링에서의 커스텀 예외처리 약간)</a>
    </h1>
  

        <a href="/2017/12/08/sentry-on-spring/" class="article-date">
  <time datetime="2017-12-08T05:19:48.000Z" itemprop="datePublished">2017-12-08</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="쎈트리-Sentry-로-서버를-감시해보자"><a href="#쎈트리-Sentry-로-서버를-감시해보자" class="headerlink" title="쎈트리(Sentry)로 서버를 감시해보자."></a>쎈트리(Sentry)로 서버를 감시해보자.</h3><p>미천한 코딩 실력과 다양한 예외 상황으로 인해 우리의 스프링 부트 서버는 항상 다양한 Exception들을 뱉어낸다. 아 사실 Exception의 발생과 코딩 실력과는 별 관련이 없을 듯하다. 오히려 적절한 시점에서 Exception을 던져 예외 상황을 맞이한 서버가 뻗지 않도록 구현하는 것은 고급 개발스킬에 해당하고, 이런 예외상황을 모두 상상해볼 수 있는 것도 개발자의 역량이라고 본다. </p>
<p>나는 그동안 다양한 종류의 Exception들을 System.out 으로 처리했었고 slf4j와 같은 로깅 프레임워크를 학습한 후엔 log.debug()나 log.error()를 불러내 콘솔에 현시하는 방법을 채택했었다. 그러나 이런 방법은 Exception 상황이 발생할 때에 콘솔을 주시하고 있어야 한다는 문제점이 있고 나중에 Exception에 대한 통계 정보를 만들어내는 것도 어려움이 따른다. </p>
<p>뭔가 직관적인 대시보드를 제공하면서 실시간 에러 수집이 가능한 프레임웍이나 서비스를 찾던 도중 <a href="https://sentry.io" target="_blank" rel="noopener">Sentry</a>가 눈에 들어왔고 아래 삽질기를 통해 서버사이드에서의 도입 과정을 간략히 설명해 보고자 한다. </p>
<p><em>센트리 회원가입, DSN 정보 취득 등 Trivial한 부분은 이 글에서 다루지 않는다.</em></p>
<h4 id="스프링의-Custom-Exception-Handling에-대해-알아보자"><a href="#스프링의-Custom-Exception-Handling에-대해-알아보자" class="headerlink" title="스프링의 Custom Exception Handling에 대해 알아보자."></a>스프링의 Custom Exception Handling에 대해 알아보자.</h4><p>다들 알다시피 스프링을 쓰다보면 예외 상황이 참 많이 난다. 기본적인 경우에 이런 Exception들은 “Whitelabel Error Page”라는 멋대가리 없는 페이지로 표시된다. </p>
<p>스프링은 이런 예외 상황 하에서 개발자의 책임으로 적절한 에러 표시를 띄워주기 위해 Controller, Service 등 DispatcherServlet 아래에서 일어나는 모든 예외 상황을 처리해주는 HandlerExceptionResolver 인터페이스를 두고 있다. </p>
<p>만약 어떠한 방식으로든 이 Exception Resolver가 패키지 안에서 구현된다면 당신의 서버가 내뿜는 예외 상황들의 처리가 이 Resolver 구현체에서 전담될 것이며, 동시에 Ordered 인터페이스를 구현해 각 Exception Resolver간의 순위를 정해줄 수 있다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public Class ShitExceptionResolver implements HandlerExceptionResolver, Ordered &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int getOrder() &#123;</span><br><span class="line">        //이 메소드는 Ordered 인터페이스의 구현체이다. 예외 처리기의 실행 순위를 명시해주는 것이다. </span><br><span class="line"></span><br><span class="line">        return Integer.MIN_VALUE; //숫자가 작을 수록 우선권을 갖는다. </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public ModelAndView resolveException(HttpServletRequest req, HttpServletResponse res, Object handler, Exception e) &#123;</span><br><span class="line">        //이 메소드는 HandlerExceptionResolver를 구현한 것이다.</span><br><span class="line"></span><br><span class="line">        (...에러를 모델에 추가하는 로직은 알아서 잘 구현하자.)</span><br><span class="line"></span><br><span class="line">        return &quot;error&quot;; //template 폴더에서 error.html을 찾아서 돌려주면 된다.</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>상기한 코드에서 getOrder()의 구현을 통해 최상위 에러 처리 로직으로 스프링 빈에 등록되었으므로, 이제 서버가 뱉어내는 모든 예외는 최우선적으로 위의 Resolver가 처리하게 된다. </p>
<p><strong>뭔가 감이 오지 않는가?</strong> 우리는 이제 저 구현체가 모든 에러 정보를 흡수한 다음, 우리의 센트리 계정으로 중계해 주게끔 구현할 것이다. </p>
<h4 id="Dependency-추가-및-터닦기-작업"><a href="#Dependency-추가-및-터닦기-작업" class="headerlink" title="Dependency 추가 및 터닦기 작업"></a>Dependency 추가 및 터닦기 작업</h4><p>센트리 포탑을 설치하기 위한 기초 터닦기 공사를 해보자. </p>
<p>Maven(당연한 얘기지만 Gradle도 상관 없다) dependency를 아래와 같이 추가해 준다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;io.sentry&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;sentry&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.6.3&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>이렇게 추가된 클래스 Sentry를 통해 static 메소드 몇 가지를 쓰게 된다. </p>
<p>그리고 Component Scan이 이뤄질 수 있는 위치에 아래와 같이 Bean을 선언해주자. (이게 필요한 과정인지는 모르겠으나 일단 적어둔다. 경험자 분들의 태클 환영)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public HandlerExceptionResolver sentryExceptionResolver() &#123;</span><br><span class="line">    return new SentryExceptionResolver();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exception-Resolver-구현-에러-전송"><a href="#Exception-Resolver-구현-에러-전송" class="headerlink" title="Exception Resolver 구현, 에러 전송"></a>Exception Resolver 구현, 에러 전송</h4><p>아래와 같이 Exception Resolver를 구현해 지긋지긋한 Exception들을 Sentry로 보내버리자. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class SentryExceptionResolver implements HandlerExceptionResolver, Ordered &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int getOrder() &#123;</span><br><span class="line">        return Integer.MIN_VALUE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public ModelAndView resolveException(HttpServletRequest req, HttpServletResponse res, Object o, Exception e) &#123;</span><br><span class="line">        </span><br><span class="line">        Sentry.init(YOUR_DSN); //여기서 센트리를 초기화시킨다. </span><br><span class="line">        Sentry.capture(e); //여기서 Exception을 센트리로 보내버린다.</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>null을 리턴하는 이유</strong>는 이 Resolver는 단순히 예외를 잡아다가 센트리로 보내버리는 중계자 역할만을 할 뿐, 의미있는 예외 처리를 수행하고 있지 않기 때문이다. resolveException() 메소드의 리턴 타입이 ModelAndView임을 주목하자. 이 메소드는 Exception을 적절히 다뤄 <em>사용자가 의미있는 정보를 UI적으로 취득할 수 있게 해주는 것</em>에 의미를 두는 메소드이다. </p>
<p>SentryExceptionResolver는 그와 같은 기능을 못 해주고 있으므로 null을 리턴해 차순위 Exception Resolver가 본연의 기능을 수행할 수 있도록 양보해 주는 것이 맞다. </p>
<p>아, 물론 원한다면 SentryExceptionResolver가 view 기능도 수행하게끔 구현해도 되지만 <strong>비추한다.</strong> 단일 책임의 원칙에 부합하지 않는 모습이라고 본다. </p>
<h4 id="끝났다"><a href="#끝났다" class="headerlink" title="끝났다."></a>끝났다.</h4><p>당신의 서버는 이제 당신의 Sentry 계정으로 예쁘게 Exception 정보를 보내줄 것이다. </p>
<p><img src="https://s3.ap-northeast-2.amazonaws.com/seulgiwendy.github.io-static/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-12-08+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+3.04.11.png" alt="참 쉽죠?" title="대시보드 화면"></p>
<p><strong>어때요, 참 쉽죠?</strong></p>
<p>이제 Exception을 세련되게 관리해 봅시다. </p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/12/08/sentry-on-spring/" data-id="ckk8zmese004eeo9ol0bsb5pc" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/12/08/sentry-on-spring/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Monitoring/">Monitoring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sentry/">Sentry</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/">Spring</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-why-no-optional-for-getters" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/03/why-no-optional-for-getters/">Getter에 대한 사소한 궁금증 - Getter는 Optional을 사용하면 안 될까?</a>
    </h1>
  

        <a href="/2017/12/03/why-no-optional-for-getters/" class="article-date">
  <time datetime="2017-12-03T08:53:02.000Z" itemprop="datePublished">2017-12-03</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="Java의-Getter는-Optional을-돌려주면-안-될까"><a href="#Java의-Getter는-Optional을-돌려주면-안-될까" class="headerlink" title="Java의 Getter는 Optional을 돌려주면 안 될까?"></a>Java의 Getter는 Optional을 돌려주면 안 될까?</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;Null은 나의 백만 불 짜리 실수다.&quot;</span><br><span class="line">-찰스 앤서니 리처드 호어, 영국의 컴퓨터 과학자, Null의 창시자</span><br></pre></td></tr></table></figure>
<p>개발 공부를 시작하던 몇 달 전에 가장 이해하기 어려운 개념은 재귀함수도 아니고 인터페이스도 아닌 Null 값이었다. </p>
<p>Null의 모호성 때문이었다. 이 값(?)은 값이 없다고 하기에도 모호하고 그렇다고 뭔가를 나타내고 있는 것도 아니다. return 값으로도 사용할 수 있고 인스턴스 변수 자리에도 잘 들어갈 수 있으며 그 당시에는 뭔가 문자열같다(!) 는 느낌도 받았었다. 그래서 아래와 같은 괴상한 코드를 짠 일도 있다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String foo = null;</span><br><span class="line">if (foo == &quot;null&quot;) &#123;</span><br><span class="line">    System.out.println(&quot;foo is null!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>지금 보면 헛웃음밖에 나오지 않는 정말 우스꽝스러운 코드 뭉치이지만 <strong>그땐 진지했다.</strong> 객체 개념, 클래스 개념이 확실하게 서 있지 않던 시기에 짠 코드들은 툭하면 NPE를 뱉어 댔고 Null값을 어떻게 처리할 지도 난감했었던 기억이 난다. </p>
<p>개발 공부를 시작한 뒤 시간이 좀 흘러, 적어도 <em>Null이 문자열은 아니다</em> 라는 사실을 알게된 시점부터 나는 아래와 같은 Null check 로직 (내 맘대로 갖다 붙인 이름이다)을 구현하기 시작했다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Foo &#123;</span><br><span class="line">    </span><br><span class="line">    private String bar;</span><br><span class="line">    </span><br><span class="line">    public String getBar() &#123;</span><br><span class="line">        if (bar == null) &#123;</span><br><span class="line">            return &quot;Fuck You! There is no Bar anymore!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return this.bar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이런 식의 구현은 한동안 계속되었던 것으로 기억한다. 아니, 솔직히 말하면 <strong>이 이상의 방어적이고 효율적인 구현은 있을 수 없다</strong>고 생각했었다. 나는 공부를 시작하던 시점부터 Java 8 환경에서 작업했으므로 레거시 이슈 같은 것은 전혀 아니었고….내가 Java 8에 대한 충분한 이해 없이 개발 공부를 시작한 것에 따른 부족함이었다. </p>
<p>공부에 점점 깊이를 더해가게 되면서 함수형 프로그래밍의 개념과 Java 8의 Stream, Lambda와 같은 학습 주제들을 공부하게 되고, Optional에 대해 알게되면서 Null값을 아래와 같이 wrapping하는 일이 익숙해지게 되었다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; foo = Bar.getFoo();</span><br><span class="line">String fuck = foo.orElseThrow(() -&gt; new NoSuchElementException(&quot;no value!&quot;));</span><br></pre></td></tr></table></figure>
<p>그런데 위의 코드를 보면 Bar 클래스의 Getter인 .getFoo()가 Optional을 돌려주고 있는 것을 알 수 있고, Getter가 Optional을 돌려주는 위와 같은 상황을 <em>지금까지의 개발 학습과 코드 리뷰, 깃허브 레파지토리 서핑에서 별로 본 적이 없다.</em></p>
<p>심지어 lombok도 Optional을 돌려주는 Getter를 만들어주는 옵션이 없다. <strong>Getter 메소드는 Optional을 돌려주면 안 되는 걸까?</strong> 문득 든 궁금증이지만 한 두 시간 동안 구글을 뒤져 가며 내린 나름의 결론을 기록해 두고자 한다. </p>
<p>(나름의 결론이니까 틀릴 수 있고 아마 틀릴 거다. 그래도 기록이란 게 그 자체로 의미가 있으니 선배 개발자들과 공유하며 다양한 의견 들어보고 싶다.)</p>
<h4 id="왜-Optional을-리턴하는-Getter는-없냐"><a href="#왜-Optional을-리턴하는-Getter는-없냐" class="headerlink" title="왜 Optional을 리턴하는 Getter는 없냐."></a>왜 Optional을 리턴하는 Getter는 없냐.</h4><p>Stack Overflow의 <a href="https://stackoverflow.com/questions/26327957/should-java-8-getters-return-optional-type" target="_blank" rel="noopener">Should Java 8 getters return Optional type?</a> 라는 글을 함께 읽어보며 논의를 전개해 나가고 싶다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;...Optional type introduced in Java 8 is a new thing for many developers.</span><br><span class="line"></span><br><span class="line">Is a getter method returning Optional&lt;Foo&gt; type in place of the classic Foo a good practice? Assume that the value can be null.&quot;</span><br><span class="line"></span><br><span class="line">-자바 8의 옵셔널은 많은 개발자들에게 새로운 기능입니다(주: 이 글은 3년 전에 작성되었다). Foo라는 클래식 타입 대신 Optional로 감싼 값을 돌려주는 Getter를 만드는 것이 좋은 구현인가요? 값이 null일 수 있다는 전제 하에...&quot;</span><br></pre></td></tr></table></figure>
<p><strong>나와 똑같은 고민을 (3년 전에) 누가 이미 한 모습이다.</strong></p>
<p>가장 많은 추천을 받은 답변을 아래에 조금씩 옮겨보겠다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;...Of course, people will do what they want. But we did have a clear intention when adding this feature, and it was not to be a general purpose Maybe or Some type, as much as many people would have liked us to do so. Our intention was to provide a limited mechanism for library method return types where there needed to be a clear way to represent &quot;no result&quot;, and using null for such was overwhelmingly likely to cause errors.&quot;</span><br><span class="line"></span><br><span class="line">&quot;...For example, you probably should never use it for something that returns an array of results, or a list of results; instead return an empty array or list. You should almost never use it as a field of something or a method parameter.</span><br><span class="line"></span><br><span class="line">I think routinely using it as a return value for getters would definitely be over-use.&quot;</span><br><span class="line"></span><br><span class="line">&quot;...It is important to note that the intention of the Optional class is not to replace every single null reference. Instead, its purpose is to help design more-comprehensible APIs so that by just reading the signature of a method, you can tell whether you can expect an optional value. This forces you to actively unwrap an Optional to deal with the absence of a value.&quot;</span><br></pre></td></tr></table></figure>
<p><strong>미국말이지만 이야기하고자 하는 바는 명쾌하다.</strong> Optional을 맹신하거나 오남용하지 말라! 필요한 곳에만 사용하라! <em>값이 없을 상황이 명백하게 기대되는 경우에만 사용하라!</em> 정도로 요약해 볼 수 있을 것 같다. </p>
<h4 id="그렇다면-Optional을-돌려주는-Getter는-의미있는가"><a href="#그렇다면-Optional을-돌려주는-Getter는-의미있는가" class="headerlink" title="그렇다면 Optional을 돌려주는 Getter는 의미있는가?"></a>그렇다면 Optional을 돌려주는 Getter는 의미있는가?</h4><p>나의 생각으로 내린 결론부터 말하자면, <strong>95%의 경우에 의미가 없을 거라고 본다.</strong> </p>
<p>첫째, 값을 꺼내오기 위해 만든 Getter가 <strong>찾아올 값이 없을 거라고 기대하는 상황 자체가 자기 모순이다.</strong> 우리가 Getter 메소드를 구현하는 것은 인스턴스가 의미 있는 값을 가지고 있고, 그 값을 직접 변형하거나 사용하기 위해 그렇게 하는 것이다. </p>
<p>만약 Getter 메소드가 찾아올 값이 null일 수도 있다면 <strong>애초에 그 메소드는 Getter가 아니어야 타당하다.</strong> 즉, null을 돌려줄 수 있는 Getter가 설계된 상황은 그 자체로 충분한 객체지향적 설계를 하지 않은 상황이다. </p>
<p>만약 Getter가 null을 다뤄야한다면 우리는 그 값을 직접 꺼내오는 메소드가 아닌 그 값을 인스턴스 차원에서 변형하고, 바꿀 수 있는 메소드를 구현해야 한다. </p>
<p>Optional의 도입 취지를 다시 한 번 기억하자. Optional은 <em>의미 있는 null을 위한 보금자리</em> 라고 내게는 이해된다. Getter가 null을 돌려준다면, 그건 의미 있는 null일까? 다시 곰곰히 생각해보면 분명히 아닐 거라 생각된다. </p>
<p>둘째, 레거시 프레임웍들과의 호환성 문제가 있다. Java Bean의 표준 규약으로서의 Getter는 Optional을 돌려주지 않기 때문에, Getter를 통해 객체에서 값을 받아다 써야 하는 다양한 프레임워크들과의 호환성 문제가 분명히 생길 것이다.</p>
<p>마지막으로, 불필요한 코딩량의 증가가 우려된다. null값이 별로 기대되지도 않는 맥락 속에서 Optional로 wrapping된 값을 가져오기 위해 추가적인 코드 작성이 필요해지는 상황이 연출되는 것이다. </p>
<p>아래 예제를 통해 살펴보고 싶다. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Bar &#123;</span><br><span class="line">    private String what;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String foo = Bar.getWhat();</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Foo &#123;</span><br><span class="line">    private String what; </span><br><span class="line"></span><br><span class="line">    private Optional&lt;String&gt; getWhat() &#123;</span><br><span class="line">        return Optional.ofNullable(this.what);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String foo = Foo.getWhat().orElseThrow(() -&gt; new NoSuchElementException(&quot;no value!&quot;));</span><br></pre></td></tr></table></figure>
<p>의미있는 null의 사용이 기대되지 않는 상황에서, null 값을 굳이 Optional로 감싸고, 그렇게 감싸진 값을 꺼내오기 위해 추가적인 코딩 분량이 발생하는 상황이 그렇게 좋아보이지 않는다. </p>
<p>Optional 객체에서 .get()을 호출하여 바로 값을 꺼내오면 되지 않나? <strong>그런 구현은 정말 지양해야 한다고 본다.</strong> .get()을 부르는 것은 Optional을 Optional답지 않게 사용하고 있는 모습이라 생각된다. .get()은 null값이 발생할 가능성을 일축하는 메소드라고 볼 수 있는데, 그러면 애초에 왜 리턴값으로 Optional을 사용하기로 결정했나? 생각해 볼 필요도 없는 문제라고 본다. </p>
<h3 id="결론-Getter의-리턴-값으로-Optional-객체를-사용하는-것은-의미-없다"><a href="#결론-Getter의-리턴-값으로-Optional-객체를-사용하는-것은-의미-없다" class="headerlink" title="결론: Getter의 리턴 값으로 Optional 객체를 사용하는 것은 의미 없다."></a>결론: Getter의 리턴 값으로 Optional 객체를 사용하는 것은 의미 없다.</h3><p>Getter의 리턴 값으로 Optional을 돌려주는 것은 <em>의미도 없고, 호환성 문제가 발생할 수 있으며, 불필요한 코딩 분량까지 발생시킬 여지가 있다.</em> </p>
<p>Getter의 구현을 최소화하는 것이 객체지향젹인 사고방식이라는 말을 들은 적이 있다. 그 말씀에 전적으로 동의한다. 값을 꺼내오지 말고 값의 처리결과를 받아보는 것이 최선의 선택이다. </p>
<p>다시 한 번 강조하고 싶은데, 내가 생각하기에 null을 돌려줄 수도 있는 Getter 메소드는 정말 필요한 Getter인지 다시 한 번 클래스의 설계를 점검해보는 것이 좋겠다. Getter가 의미 있는 null을 반환해야 하는 상황은 정말 겪기 어렵다. </p>
<h4 id="추가-학습-과제"><a href="#추가-학습-과제" class="headerlink" title="추가 학습 과제"></a>추가 학습 과제</h4><ul>
<li>정말 Optional을 돌려주는 Getter가 내 주변에 없는지 다시 한 번 찾아본다. </li>
<li>lombok이 Getter를 만들어주는 원리에 대해 학습한다. </li>
<li>Java Bean의 표준 규약에 대해 다시 한 번 학습한다. </li>
</ul>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/12/03/why-no-optional-for-getters/" data-id="ckk8zmewq00afeo9orv0c431s" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/12/03/why-no-optional-for-getters/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Functional-programming/">Functional_programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Optional/">Optional</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171120" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/20/til-20171120/">TIL-20171120</a>
    </h1>
  

        <a href="/2017/11/20/til-20171120/" class="article-date">
  <time datetime="2017-11-20T14:05:48.000Z" itemprop="datePublished">2017-11-20</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-20-월-오늘의-T-I-L"><a href="#2017-11-20-월-오늘의-T-I-L" class="headerlink" title="2017.11.20(월) 오늘의 T.I.L."></a>2017.11.20(월) 오늘의 T.I.L.</h3><p>금요일부터 시작해 주말 내내 정말 아팠다. 피똥 쌌다. 최근 몇년간 중에 가장 아팠던 것 같다.<br>몸이 은근히 많이 피로해있음을 알 수 있는 며칠간의 생활이었다. 아직까지도 컨디션이 100%가 아니다. 뭔가 소화가 안되는 느낌이 계속 있었는데 오늘 점심 이후로 또 계속 화장실을 드나들기 시작했다. </p>
<p>천천히 템포를 정상 수준으로 올리고 싶다. 오늘은 의도적으로 많은 일을 하지 않았다. 여섯시 반 땡 하자마자 집에 왔다.<br>당장 금요일부터 야간근무를 또 해야 하는데 매일 피똥싸게 생겼다.<br>큰일이다. </p>
<ul>
<li><p>트렐로 구현 - Model 클래스 구상, Repository까지 코딩 </p>
<ul>
<li>Model 클래스를 구현해봤다. 내가 Trello를 쓰지 않기 때문에 도메인 지식의 부족으로 초반 애를 좀 먹었다.</li>
<li>지금 업무용으로 트렐로를 적극 활용하고 있는 CU의 도움을 얻어 도메인 클래스를 구상하고, 리파지토리 제작까지 완료하였다. </li>
<li>Spring Data REST를 쓸 준비는 모두 마친 모습. 학습이 좀 더 필요하긴 하다. 비즈니스 로직 자체는 수요일까지 다 준비할 수 있을듯.</li>
</ul>
</li>
<li><p>Sentry 설치하느라 삽질. </p>
<ul>
<li>결국 해결 못 함. </li>
<li>easy_install이 문제인 건지 Sentry에서 땡겨온 바이나리가 문제인 건지 제대로 시작이 안 된다. </li>
<li>Python Virtualenv 방식으로 했더니 사용성도 떨어지고 여러가지 애로사항이 많다. 파이썬 좋아하는 사람들 이해가 안 된다. 파이썬으로 배포되는 오픈소스들 깔끔하게 딱딱딱 설치되는 적이 한 번도 없다. </li>
<li>Docker 방식이 있다니까 Docker 이미지 갖고와서 다시 한 번 시도해 봐야겠다. 어차피 공부할 주제이기도 하고.. </li>
<li><p>온프레미스 방식 말고 그냥 상용 서비스 쓰는 방법이 있긴 한데 최후의 수단으로 남겨두고 싶다. 참고로 초보몽키 양반은 처음부터 상용서비스 쓴 것 같다. 그보다는 더 깊은 경험 해보고 싶다. </p>
<p>백엔드 개발자를 꿈꾼다는 사람이 다 배포되어 있는 오픈소스 서버 하나 세팅 못 잡아서 상용 서비스 쓰는 경험 하고싶지 않다.</p>
</li>
</ul>
</li>
<li><p>Docker 잠시 공부했다. </p>
<ul>
<li>Docker 공부하고 EC2에 우분투 콘테이너 실행하는 것 까지 해봄. 별 의미 없는 거지만…. </li>
</ul>
</li>
</ul>
<p>내일은 제발 몸이 좀 회복했으면 좋겠다. 뭐가 문제인지? 아침에 죽 먹고, 점심에 계란찜 먹고, 저녁에 또 죽 먹었는데….<br>내일도 회복이 안 되면 내과에서 진찰 받고 며칠간 드러누울 예정이다. 정말 큰일이다, 중요한 시기에…..</p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/20/til-20171120/" data-id="ckk8zmeu00064eo9oelbob2de" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/20/til-20171120/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Daily/">Daily</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171115" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/15/til-20171115/">TIL-20171115</a>
    </h1>
  

        <a href="/2017/11/15/til-20171115/" class="article-date">
  <time datetime="2017-11-15T12:25:32.000Z" itemprop="datePublished">2017-11-15</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-15-수-오늘의-T-I-L"><a href="#2017-11-15-수-오늘의-T-I-L" class="headerlink" title="2017.11.15 (수) 오늘의 T.I.L."></a>2017.11.15 (수) 오늘의 T.I.L.</h3><p>여러모로 어수선한 하루였다. 오후에 밥먹고 졸릴 때쯤 있었던 <a href="http://www.kma.go.kr/weather/earthquake_volcano/report.jsp?prevEqkType=a&amp;eqkType=a&amp;eqk=eqk_web_11_20171115142931.xml&amp;x=22&amp;y=7" target="_blank" rel="noopener">지진으로</a> 분위기가 뭔가 어수선해졌고(나 혼자 그랬던건가?) 일본 여행 이후 오랜만에 지진동을 몸으로 느끼는 경험을 했다. 실내의 모든 전화기가 긴급재난경보 <a href="https://en.wikipedia.org/wiki/Cell_Broadcast" target="_blank" rel="noopener">CBS 메시지</a>를 전하는 모습은 뭔가 쌔한 느낌을 선사했다. </p>
<p>그리고 야간 잔업 중에 수능 시험일 연기가 확정됨으로써 나는 1주일의 휴가를 더 갖게 되었다. 피해를 입은 분들께는 유감이지만 나에게는 마지막 프로젝트 구현을 앞두고 일주일의 여유 시간을 더 갖게된 셈이라 큰 도움을 받는 기분마저 들었다. </p>
<p>오늘은 특별한 계획 없이 손에 닿는대로 하고싶은 일들을 했다. 능률은 떨어졌지만 하루를 허투루 보냈다는 생각은 전혀 들지 않는다. 다이어트에도 치팅 데이가 필요하듯 오늘같은 날들이 오랜 학습의 기간 중에서도 종종 필요하다는 생각이다. </p>
<ul>
<li><p>ORM 프레임워크 - JDBC Manager 리팩토링</p>
<ul>
<li>ORM 프레임워크의 핵십인 <strong>범용성있는 DB <-> POJO 매핑</-></strong>을 위해서는 이번 리팩토링이 필수적이었다.</li>
<li>내가 구상한 방식은 POJO 클래스의 새로운 인스턴스를 java.lang.reflect의 .newInstance() 메소드로 생성하고, 그 메소드가 갖고 있는 필드의 이름을 뽑아낸 다음 ResultSet에서 .getObject(String fieldname)으로 뽑아와 새로 만들어진 인스턴스에 주입하는 방식이었다. </li>
<li>직접 구현해보니 문제점이 많았는데, 여튼 실제 구현 이전 기획 단계만으로도 Spring JPA가 어떻게 작동하는지 공부할 수 있었고 특히 Reflection 클래스나 Proxy 개념에 대해 심층학습할 수 있는 기회를 가졌다. </li>
<li>앞으로 트렐로 구현을 메인으로 하고 이 ORM 구현은 사이드 프로젝트로 잠시 미뤄둘 생각이다. </li>
</ul>
</li>
<li><p>트렐로 프로젝트 개발환경 세팅</p>
<ul>
<li>오랜만의 Spring Boot 프로젝트 임포트(…) 라서 버벅거렸다.</li>
<li>이번 프로젝트부터는 개발환경으로 Spring Tool Suite를 사용하지 않고 과감히 IntelliJ IDEA로 전환한다. Eclipse 기반 IDE들은 다양하게 써 봤으니 새로운 환경에 도전해보고 싶고, 가격이 비싼 인텔리제이를 대학생의 특권으로 무료로 쓸 수 있는데 프로젝트에 실전투입해보고 싶은 마음이 컸다. </li>
<li>인텔리제이 사용법과 단축키를 익힐 수 있는 계기가 되기를 기대한다. </li>
</ul>
</li>
<li><p>트렐로 프로젝트 프론트엔드 개발 계속 </p>
<ul>
<li>React로 계속 개발하고 있다. 이제 뭔가 조금씩 감을 잡고 있다. 잘만 하면 포비가 제공해 주는 템플릿보다도 더 멋진 녀석이 나오지 않을까. </li>
<li>백엔드 저장소와 분리 운영하고자 한다. 깃허브 리파지토리를 <a href="https://github.com/seulgiwendy/trello-react" target="_blank" rel="noopener">새로 팠다.</a> </li>
</ul>
</li>
</ul>
<p>코드도 코드지만 진로에 대한 고민도 계속. 맘에 들지도 않는 전공의 졸업장을 받기 위해 하고 싶고 잘할 수 있는 일을 미루는 게 맞는 일인지 고민하게 된다. </p>
<p>전공 선택에 대한 후회는 없다. 2012년의 나는 말과 글을 꽤 잘 다루는 고등학생이었다. 여러가지 어려운 상황을 극복하고 나름의 도전을 통해 입학한 대학이기에 그 과정 또한 소중하게 생각한다. 다만 5년 동안 치열하게 살다보니 바라보는 곳이 조금 달라졌을 뿐이다. </p>
<p>나는 우리 전공에서도 앞으로 개발자들이 할 일이 많아질 거라고 보고, 또 많은 대학의 미디어 전공에서 코딩을 가르치는 것을 매우 긍정적인 변화로 보고 있다. 아쉬운 점은 우리 학교의 미디어 전공은 공공재로써의 언론, 또 언론 정책에 관한 연구나 광고/홍보/마케팅 중심의 커리큘럼이 강세라 나같은 학생들이 활약할 여지가 크지 않다. </p>
<p>3년, 혹은 2년 남은 학교라면 고민할 가치도 없겠지만 딱 두 학기 남은 대학생활이라 고민이 더욱 깊어가는 것 같다. 지금 생각으로는 일단 어떤 방식으로든 (평점을 챙기지 않고, 졸업 요건만 갖추는) 졸업을 한 후 입사 후에 방통대 학사 편입 등으로 컴퓨터 공학의 전공 공부를 하는 방법을 생각해보고 싶다. </p>
<p>내일 아침이면 다른 생각이 떠오를 수도 있겠지. 쉽지 않지만 어떤 길이던지 태도가 관건이라고 본다. 진지하면서도 유쾌하고, 깊게 파다가도 넓이를 넓힐 수 있는 그런 유연한 태도를 유지하자. 어떻게 보면 나는 지금 참 잘 하고 있는 것 같다.</p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/15/til-20171115/" data-id="ckk8zmety0061eo9olcqq6lee" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/15/til-20171115/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/daily/">daily</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171114" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/14/til-20171114/">TIL-20171113 ~ 1114</a>
    </h1>
  

        <a href="/2017/11/14/til-20171114/" class="article-date">
  <time datetime="2017-11-14T11:52:35.000Z" itemprop="datePublished">2017-11-14</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-13-월-2017-11-14-화-이틀간의-T-I-L"><a href="#2017-11-13-월-2017-11-14-화-이틀간의-T-I-L" class="headerlink" title="2017.11.13 (월) ~ 2017.11.14 (화) 이틀간의 T.I.L."></a>2017.11.13 (월) ~ 2017.11.14 (화) 이틀간의 T.I.L.</h3><p>학습일지 포스팅을 매일 하기가 조금씩 버거워지고 있다. 여러 이유가 있겠지만 가장 큰 이유는 코드스쿼드에서 늦게까지 밤코를 마친 후 굳이 집에 와서 일지를 쓰려는 심리 때문이다.<br>밤코 마치기 전 10분정도만 할애해서 쓰고 출발하면 되는데 그걸 미루고 집에 와서 쓰려니 매일 쓰지 못한 것이다. 반성할 부분이다. </p>
<ul>
<li><p>DI 프레임워크 구현 완료, Merge까지 완료.</p>
<ul>
<li>재귀함수를 통해 bean을 생성해서 저장하는 부분이 재미있었고, 교과서 속의 알고리즘을 실제 코드 개발에 적용해 보는 좋은 경험이었다. </li>
<li>포비에게 개선점을 전달받아 리팩토링 후 머지까지 완료. </li>
<li>막상 머지되고 나서 동료들과 얘기 나눠 보니 리팩토링할 지점, 그리고 포비와 이야기나눌 지점이 몇 군데 보인다. 이 부분을 놓지 않고 계속 탐구해볼 필요성이 있다. </li>
</ul>
</li>
<li><p>ORM 프레임워크 구상 완료</p>
<ul>
<li>ORM프레임워크를 구현하기 위한 기본적인 구상을 마치고 실제 구현 단계로 접어들고 있다. </li>
<li>Repository 클래스를 inject받는 곳에 실제 구현체를 넣지 않고 Proxy를 끼워넣은 다음, 그 Proxy가 전해오는 정보를 통해 JdbcManager와 통신하게 하는 것이 1차 과제다. </li>
<li>이것은 마치 카오디오에 카세트 플레이어가 남아있던 시절, 3.5밀리미터 AUX INPUT이나 블루투스 송수신 기능을 가진 카세트테잎 모양 어댑터를 끼워넣는 모습을 연상케 한다. </li>
<li>카오디오의 구현체로서 기능을 확장하는 것이 아닌 카세트테잎 모양 어댑터를 통해 기능을 확장한 것이다. 비슷한 원리로 생각하고 접근하면 구현이 쉽겠다. </li>
<li>Proxy로 전달될 메소드의 이름을 파싱해서 적합한 SQL Query로 던져주는 것까지가 ORM 프레임워크의 구현과제가 아닐까 싶다. </li>
</ul>
</li>
<li><p>트렐로 프로젝트의 프론트엔드를 리액트로 구현 시작.</p>
<ul>
<li>static resource가 프로젝트 소스에 다 있기 때문에 사실 그렇게 어려운 구현은 아닐…거라 생각되지만.</li>
<li>마크업을 리액트로 고대로 옮기는 작업이 그렇게 쉬운 일은 아니다. </li>
<li>npm에 Google materialize CSS 기반 리액트 웹앱을 쉽게 만들어주는 라이브러리가 있어서 갖다 쓰고, 여러 강좌도 시청하며 따라해보려 한다. 리액트 기반으로 프론트가 작동한다면 정말 좋을 것 같다. </li>
</ul>
</li>
</ul>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/14/til-20171114/" data-id="ckk8zmetv005yeo9obbvco5ja" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/14/til-20171114/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ORM/">ORM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171112" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/12/til-20171112/">TIL-20171110 ~ 1112</a>
    </h1>
  

        <a href="/2017/11/12/til-20171112/" class="article-date">
  <time datetime="2017-11-12T14:38:50.000Z" itemprop="datePublished">2017-11-12</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-10-12-금-토-일-3일간의-T-I-L"><a href="#2017-11-10-12-금-토-일-3일간의-T-I-L" class="headerlink" title="2017.11.10 ~ 12 (금, 토, 일) 3일간의 T.I.L."></a>2017.11.10 ~ 12 (금, 토, 일) 3일간의 T.I.L.</h3><h4 id="여러가지-사정이-겹쳐-3일치-틸을-몰아-쓰게-되었다"><a href="#여러가지-사정이-겹쳐-3일치-틸을-몰아-쓰게-되었다" class="headerlink" title="여러가지 사정이 겹쳐 3일치 틸을 몰아 쓰게 되었다."></a>여러가지 사정이 겹쳐 3일치 틸을 몰아 쓰게 되었다.</h4><ul>
<li><p>DI 프레임워크 구현 돌입. </p>
<ul>
<li>Reflection의 개념을 숙지하고 진행한다면 큰 어려움 없을 것이라….생각했었다.</li>
<li>금요일 오후부터 시작해 토요일에 집중적으로 1단계 구현을 했다. test.di() 까지 통과. </li>
<li>잘못된 JCF 설명으로 인해 몇 시간을 허비했다. 내가 갖고 있는 책에는 .put() 메소드가 리턴 값으로 지금 막 저장한 오브젝트를 돌려준다고 되어있다. 자바독을 열어보니 그런 거 없고 처음 저장하는 값의 경우 리턴값은 null이었다. 널이 날 수 없는 곳에서 자꾸 널이 나서 답답했는데 한방에 해결. 좀 황당…. </li>
<li>Repository의 경우 인터페이스만 정의되어 있고 실제 구현체는 다른 빈이 맡게 된다. 이런 경우 어떻게 inject 할 수 있는지? instanceof 등의 연산자로 구현체를 찾아 넣어주면 되는 건가? </li>
</ul>
</li>
<li><p>REST API에 관한 얘기. </p>
<ul>
<li>미리 예습했던 내용에 덧붙여 좀 더 얘기함. 별도 포스팅으로 정리하겠다. </li>
<li>Spring Data REST가 흥미로워보임. 아울러 Angular.js 나 React.js와 같은 웹앱의 작동 방식도…. </li>
<li>간단한 리액트나 앵귤러 정도는 스스로 만들 줄 알아야 백엔드 학습이 더 재밌어질 것 같다. </li>
<li>트렐로 프로젝트에 대해 잠시 얘기 나눔. 포비 말씀 대로 리액트 기반으로 만들어도 재밌을 것 같고, <a href="https://sentry.io" target="_blank" rel="noopener">Sentry</a>와 같은 모니터링 도구를 넣어보는 것도 재밌지 않을까. </li>
</ul>
</li>
<li><p>React Native 강의 시청. </p>
<ul>
<li>redux를 활용한 예제. </li>
<li>‘뽀모도르 타이머’ 라는 걸 만드는 건데 별로 흥미 없는 주제라 진도 뽑기가 힘들다. </li>
</ul>
</li>
<li><p>Lotto 구현 - 깃 꼬인 것 해결하고 PR 날림. </p>
<ul>
<li>제공받은 코드 한 줄 없이 처음부터 내가 짰는데 코다시 체크가 네 개밖에 걸리지 않다니. 솔직히 기분이 좀 좋았음.</li>
<li>걸린것은 얼른 고쳐서 다시 커밋 앤 푸시. 이제 깨끗한 상태다. </li>
</ul>
</li>
</ul>
<p>당장 구직을 할 것은 아니지만 스스로를 되돌아보는 의미로 자기소개서와 이력서 등을 꾸며보려고 하는데, 백지 상태에서 시작하려니 막막한 느낌이 드는 것은 사실이다. </p>
<p>금요일 밤엔 오랜만에 대학 친구들 만나 스시뷔페 먹고 (…) 놀았다. 술 한 방울 없이 재밌게 놀 수 있는 친구들이라 좋다. </p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/12/til-20171112/" data-id="ckk8zmett005weo9onbdibnci" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/12/til-20171112/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react-native/">react_native</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171109" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/10/til-20171109/">til-20171109</a>
    </h1>
  

        <a href="/2017/11/10/til-20171109/" class="article-date">
  <time datetime="2017-11-09T15:18:02.000Z" itemprop="datePublished">2017-11-10</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-09-목-오늘의-T-I-L"><a href="#2017-11-09-목-오늘의-T-I-L" class="headerlink" title="2017.11.09 (목) 오늘의 T.I.L."></a>2017.11.09 (목) 오늘의 T.I.L.</h3><ul>
<li>DI, Container 기반 로또 완성. <ul>
<li>잘 한 건지 못 한 건지…..</li>
<li>게임 구현에 필요한 모든 객체를 LottoContainer에서 관리하고, LottoApplication에서 LottoContainer.execute() 를 실행하면 그 어떠한 추가 구현도 필요 없이 게임이 실행됨. </li>
<li>재밌게 코딩한 과제였다. 지금까지 배운 모든 디자인 패턴과 DI 등의 개념을 집대성해본 재밌는 경험이었다. </li>
</ul>
</li>
</ul>
<p>로또 코드 중에서… 로또 숫자 입력을 인터페이스로 구현하고 Lotto 객체를 만들 때 해당 인터페이스를 주입시켰다. (맞는 표현인지?)</p>
<p>즉 아래와 같은 구현이 가능해졌다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PurchaseStrategy</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoLottoPurchaseStrategy</span> <span class="keyword">implements</span> <span class="title">LottoPurchaseStrategy</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">selectNumbers</span><span class="params">(Scanner scn)</span> </span>&#123;</span><br><span class="line">		List&lt;Integer&gt; returnList = RandomUtils.getRandomLottoList(<span class="keyword">new</span> Random());</span><br><span class="line">		Collections.sort(returnList);</span><br><span class="line">		System.out.println(<span class="string">"자동선택 번호 : "</span> + returnList);</span><br><span class="line">		<span class="keyword">return</span> returnList;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(InputTypes type)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> InputTypes.AUTO == type;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserLotto</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> List&lt;Integer&gt; numbers;</span><br><span class="line">	<span class="keyword">private</span> LottoPurchaseStrategy lps;</span><br><span class="line">	<span class="keyword">private</span> Scanner scn;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">UserLotto</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UserLotto</span><span class="params">(LottoPurchaseStrategy lps, Scanner scn)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.scn = scn;</span><br><span class="line">		<span class="keyword">this</span>.lps = lps;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getNumbers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> numbers;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumbers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.numbers = lps.selectNumbers(scn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>이와 같이 중복코드를 엄청나게 줄이면서도 사용자의 입력에 따른 분기 처리를 else if나 switch 없이 구현할 수 있었다.</strong><br>무엇보다 코딩량이 꽤 줄어들었고, 자동 / 수동 외에 다른 방식의 로또 생성 로직이 생긴다 해도 <em>UserLotto는 한 줄도 건드리지 않은 채</em> 구현을 바꿀 수 있게 되었다. </p>
<p>이번 구현을 통해 배운 점은 별도의 포스팅으로 정리할 예정. </p>
<ul>
<li><p>REST API, 내일 포비와 즐겁게 이야기 나누기 위해 알고 있던 개념 정리하고 몇 가지 개념 더 잡아봄. </p>
</li>
<li><p>니꼴라스의 React Native 강의, Redux 사용법 배움. </p>
<ul>
<li>React Native 처음 배우면서 Props를 주고받는 방법을 접했을 때, 아 이거 애플리케이션의 복잡도가 높아지면 분명히 문제가 되겠구나 생각했는데, 역시 해결해주는 라이브러리가 있었다.</li>
</ul>
</li>
</ul>
<p>내일이면 벌써 4주차 마지막 날, 개인적으로는 다음주 수요일 즈음엔 트렐로 프로젝트에 진입할 수 있었으면 하는 바램이다.<br>언제 어떻게 쓰일지는 모르겠지만 자기소개서와 이력서도 말끔하게 한 번 써보고 심신을 가다듬는 계기로(….) 삼고자 한다. </p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/10/til-20171109/" data-id="ckk8zmets005ueo9o71b9eq9e" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/10/til-20171109/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Refactoring/">Refactoring</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171108" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/08/til-20171108/">TIL-20171107 ~ 08</a>
    </h1>
  

        <a href="/2017/11/08/til-20171108/" class="article-date">
  <time datetime="2017-11-08T11:53:37.000Z" itemprop="datePublished">2017-11-08</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-07-화-11-08-수-이틀간의-T-I-L"><a href="#2017-11-07-화-11-08-수-이틀간의-T-I-L" class="headerlink" title="2017.11.07(화) ~ 11.08(수) 이틀간의 T.I.L."></a>2017.11.07(화) ~ 11.08(수) 이틀간의 T.I.L.</h3><ul>
<li><p>PR 내용에 대한 코드 리뷰 진행, 리팩토링. </p>
<ul>
<li>이로써 MVC 3단계까지 마무리. Merge까지 완료. </li>
<li>Reflection API에 대한 심화 내용까지 이해할 수 있어서 좋았다. </li>
<li>Spring Framework을 단순 학습하고 갖다 쓰기만 할 때는 절대 해소할 수 없던 궁금증들을 해소할 수 있어서 좋았다. </li>
<li>또 개인적 도전과제인 ‘for 없이 코딩하기’ 를 어느정도 실현할 수 있어서 좋았다. stream API와 함수형 프로그래밍으로 많이 전환한 것 같아 기분이 좋다. </li>
</ul>
</li>
<li><p>Repository 라이브러리 구현….</p>
<ul>
<li>진도가 안 나간다. 기본적인 Object Mapping에서조차 헤매고 있다. </li>
<li>그리 어려워보이지 않아 시작한 내용인데 의외로 까다롭고 난이도가 높아 당황스럽다. </li>
<li>아직 팀원들이 2단계 마무리를 못 한 상태이므로 같이 3단계까지 동 타이밍에 마무리짓고 트렐로로 넘어가는 것이 맞다고 생각된다. 팀원들이 3단계를 마무리할 때 까지는 이 내용에 대한 심화 학습을 혼자서 진행하고 싶다. </li>
<li>Proxy에 대한 더 깊은 이해가 필요하다. </li>
</ul>
</li>
<li><p>토비의 스프링 읽음. </p>
<ul>
<li>당연히 다 읽은 건 아니다.</li>
<li>IoC와 DI 파트를 집중적으로 읽었다. AOP(Aspect-Oriented Programming)에 대해서도 조금 알게 되었다. </li>
<li>BeanFactory, Spring Container API를 이해하는 것이 Spring Framework을 이해하는 일종의 SPOF…가 아닐까 하는 생각 해 봤다. </li>
</ul>
</li>
<li><p>로또 다시 구현. </p>
<ul>
<li>언제적 로또냐. 다시 해 보기로 했다. </li>
<li>옆에서 클로이가 중얼중얼 하면서 재밌게 개발을 하길래 나도 다시 구현해보고 싶어졋다. </li>
<li>옛날 방식대로 하면 아마 한시간 반 정도면 다 코딩했을 테지만, 그런 반복은 의미없다고 생각되어 완전히 새로운 코드를 만들고 있다.</li>
<li>Annotation-based, Factory 패턴, Container 개념, DI 등 해볼 수 있는 기술적 실험은 다 해보려고 한다. 또 실제로 이런 구현을 하면서 .getInstance() 없는 싱글톤 구현이나 테스트 케이스 등 구현에 더 편리한 점이 생겼음을 몸으로 느끼는 중이다. </li>
<li>완성되고 나면 다른 팀원들의 코드와 비교해 보면서 접근 방식의 차이, 사고방식의 차이 등에 대해 팀원 그리고 포비와 재밌는 이야기 나누는 시간 갖는 것도 의미있을 것 같다. </li>
</ul>
</li>
</ul>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/08/til-20171108/" data-id="ckk8zmeto005peo9otqgyma08" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/08/til-20171108/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Refactoring/">Refactoring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pobi-framework/">pobi-framework</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-til-20171106" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/06/til-20171106/">TIL-20171106</a>
    </h1>
  

        <a href="/2017/11/06/til-20171106/" class="article-date">
  <time datetime="2017-11-06T11:43:32.000Z" itemprop="datePublished">2017-11-06</time>
</a>
      </header>
    
    <div class="article-entry-abstract" itemprop="articleBody">
      
        <!--<h3 id="2017-11-06-월-오늘의-T-I-L"><a href="#2017-11-06-월-오늘의-T-I-L" class="headerlink" title="2017.11.06(월) 오늘의 T.I.L."></a>2017.11.06(월) 오늘의 T.I.L.</h3><ul>
<li><p>MVC 3단계 구현 1차 마무리, PR 전송.</p>
<ul>
<li>Annotation-based Controller와 Legacy Request Mapping이 공존하는 형태.</li>
<li>코드 구현에 있어서 for문 사용을 최소화하고 스트림과 람다를 최대한 활용.</li>
<li>람다식 내에서 익셉션을 처리하는 부분, 즉 Wrapper클래스를 아직 구현 못 함.<br>Optional과 Consumer에 대해 학습 더 하고 내일 포비에게 질문도 좀 한 뒤에 구현 시작할 예정. </li>
<li>애노테이션 기반 RestController와 Repository도 구현해보고 싶다. </li>
</ul>
</li>
<li><p>Scala 학습.</p>
<ul>
<li>자바와는 조금 다른 클래스 선언과 패러미터 받는 방식에 대해 공부. </li>
<li>욕심내어 하루에 너무 많이 공부하지 않고 조금씩만 보는 것을 목표로 진행할 예정.</li>
<li>라 스칼라 코딩단 슬랙에 가입. 영양가있는 얘기는 별로 없다. </li>
</ul>
</li>
<li><p>React Native + Redux 강의 들음.</p>
<ul>
<li>아직 초반부라 지난번에 한 번 해봐서 익숙해진 레이아웃 잡기 + 아이콘 구성만 했음. </li>
<li>Redux를 통한 상태값 관리가 이 강의의 핵심인 만큼 아직 더 진도를 나가야 할 것 같음. </li>
</ul>
</li>
</ul>
<p>오늘은 점심시간에 윗몸일으키기(…) 를 해보겟다고 괜히 까불다가 배가 너무 아팠다.</p>
-->
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="https://tech.wheejuni.com/2017/11/06/til-20171106/" data-id="ckk8zmetm005meo9o8iuv3bbc" class="article-share-link">공유</a>-->
      
        <a href="https://tech.wheejuni.com/2017/11/06/til-20171106/#disqus_thread" class="article-comment-link">댓글</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native/">React_Native</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Scala/">Scala</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; 이전</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">다음 &raquo;</a>
  </nav>

</section>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 정휘준<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> with 
      theme_by <a href="http://hexo.io/" target="_blank">mango</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/about/" class="mobile-nav-link">about</a>
  
</nav>
    
<script>
  var disqus_shortname = 'bomee';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>